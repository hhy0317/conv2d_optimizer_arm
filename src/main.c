#include "conv2d_process.h"

#include <time.h>
#include <math.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <stdint.h>

#define DEBUG_OUTPUT_ENABLE             0
#define CHECK_PROCESS_RESULT_ENABLE     1

#define REPEAT_PROCESS_COUNT            100

#define MALLOC_ADDR_ALIGNMENT_ENABLE    1
#define ALIGNED_ADDR_BYTE               16

#if (DATA_PROCESS_MODE == FLOAT_DATA_PROCESS)

// 定义假数据
static float fake_input_data[N_IN][C_IN][H_IN][W_IN] = {{{{-1.3187, 0.2886, -0.3587, 0.1604, 1.2260, 0.2811, 1.4727,
                                                           -1.4021, -0.7117, 0.1558, -0.9489, -2.0221, 1.2406, 0.6660,
                                                           1.0772, -0.1071, 0.4898, 0.7803, -0.3866, 1.3984, 0.4601,
                                                           -1.4691, 0.6158, -0.8136, 0.4523, 0.4043, -0.3714, -1.1010,
                                                           0.2511, -0.7840, 0.3976, 0.0165}},

                                                         {{-1.1823, 1.3503, -0.8916, -0.8289, 0.5984, -0.4287, -0.3028,
                                                           -0.8100, 1.6233, 0.8458, -0.6570, -1.6433, 0.4486, -1.8502,
                                                           0.1306, -0.0577, -1.0062, 0.5213, -1.3193, -0.2966, -1.3897,
                                                           -0.8016, 0.8425, -0.1094, 0.3708, -1.5970, -0.1423, 0.2918,
                                                           -0.1800, 0.4746, 0.8567, 0.8433}},

                                                         {{-1.9336, 1.2649, -1.3423, -0.3048, 0.6425, 0.9749, -1.5358,
                                                           -0.8758, 1.4613, 0.5923, 0.0771, -1.6481, 0.5230, 0.8148,
                                                           -2.0665, 0.9379, 0.0196, -0.0656, -0.2156, 0.6778, 0.6015,
                                                           -0.7915, -0.3287, -1.0275, 1.0632, 0.7810, -1.2133, -0.1072,
                                                           2.0411, -1.2348, -1.2353, 0.2351}},

                                                         {{-0.9656, -0.4278, 0.0894, -1.0889, -0.3340, 1.4033, -0.1197,
                                                           0.0530, -0.6972, -1.1064, 1.1713, -1.1273, 1.8457, 0.8838,
                                                           -0.2947, -1.0864, 0.0072, 0.0171, -0.8334, -0.7298, 0.0748,
                                                           -0.3743, -0.1299, 0.4228, 0.7495, -0.3347, 1.1060, -0.7411,
                                                           -0.4900, 0.8667, 0.2935, 1.1165}}}};

static float fake_weight_data[C_OUT][C_IN][K_H][K_W] = {{{{0.1977, -0.1404, -0.1940, -0.0742, -0.1963}},

                                                         {{0.2066, 0.0253, 0.0006, 0.1328, 0.2033}},

                                                         {{-0.2181, 0.1655, 0.0476, 0.1530, 0.0988}},

                                                         {{-0.0287, -0.0511, 0.1179, 0.0338, -0.1039}}},

                                                        {{{0.0371, 0.0398, 0.1015, -0.0650, 0.0915}},

                                                         {{0.2056, -0.1775, -0.1868, -0.0182, -0.0064}},

                                                         {{-0.0853, 0.0116, 0.0931, 0.1050, 0.1186}},

                                                         {{0.1561, -0.1325, -0.1821, -0.0744, -0.1258}}},

                                                        {{{0.1064, -0.1562, 0.0985, 0.1172, 0.0047}},

                                                         {{0.0835, 0.2086, 0.0547, 0.1160, 0.2215}},

                                                         {{0.0845, -0.2142, -0.1478, 0.1876, 0.1362}},

                                                         {{0.0421, -0.1461, 0.0640, -0.0795, 0.1694}}},

                                                        {{{0.0898, -0.1898, 0.0945, 0.2218, 0.1145}},

                                                         {{0.0324, -0.0162, 0.0488, -0.1214, 0.0799}},

                                                         {{-0.0024, 0.0023, -0.2221, 0.0299, 0.0678}},

                                                         {{-0.0586, 0.0392, -0.2074, 0.0512, 0.1480}}},

                                                        {{{-0.1085, 0.1822, 0.1703, -0.0289, -0.1220}},

                                                         {{-0.0247, -0.0625, 0.0760, -0.2019, -0.0634}},

                                                         {{-0.1365, 0.1968, 0.1085, -0.0722, 0.1748}},

                                                         {{0.0791, 0.2113, -0.0603, -0.0970, 0.1503}}},

                                                        {{{0.1885, -0.1783, -0.0585, 0.2189, 0.0346}},

                                                         {{-0.0962, -0.0794, -0.2079, -0.1370, 0.0181}},

                                                         {{-0.0413, 0.2158, 0.0055, -0.0167, 0.0268}},

                                                         {{0.1256, 0.0324, 0.1239, 0.1923, 0.0684}}},

                                                        {{{-0.0155, -0.1927, -0.0160, 0.0126, 0.0105}},

                                                         {{0.1880, 0.0074, -0.0765, 0.1002, 0.1429}},

                                                         {{-0.0018, -0.2176, 0.0679, 0.2010, 0.0993}},

                                                         {{0.0094, -0.1144, 0.0505, -0.1947, -0.0596}}},

                                                        {{{-0.0670, 0.0117, 0.2117, -0.1540, -0.1542}},

                                                         {{0.1428, 0.2012, 0.2234, -0.1393, 0.1424}},

                                                         {{-0.1883, -0.0888, 0.0244, -0.0596, 0.0578}},

                                                         {{0.0260, 0.0558, 0.2024, -0.1046, -0.0021}}},

                                                        {{{0.1513, 0.0202, 0.1536, -0.0663, -0.0061}},

                                                         {{0.0007, 0.0721, -0.0281, -0.1821, -0.0011}},

                                                         {{0.2226, -0.0835, 0.0875, 0.0256, -0.2104}},

                                                         {{-0.1099, -0.1280, 0.0652, -0.1037, -0.0150}}},

                                                        {{{0.1018, -0.0806, 0.0299, 0.1842, 0.0199}},

                                                         {{-0.1277, 0.2120, 0.1107, -0.1439, 0.1746}},

                                                         {{-0.0495, -0.0713, 0.1601, -0.0556, -0.0984}},

                                                         {{-0.1736, -0.0632, -0.0299, -0.2211, 0.2220}}},

                                                        {{{-0.0479, 0.0122, -0.0393, -0.2104, -0.1063}},

                                                         {{0.1149, -0.1299, -0.1419, -0.1338, 0.1832}},

                                                         {{-0.1345, -0.2006, -0.1510, 0.0627, 0.2034}},

                                                         {{-0.0676, 0.0122, -0.1584, 0.0965, -0.1105}}},

                                                        {{{-0.0641, -0.0118, 0.0973, -0.0704, 0.0436}},

                                                         {{0.1503, 0.1628, -0.1348, 0.1001, -0.1357}},

                                                         {{0.0582, -0.1246, 0.1999, -0.0029, 0.2034}},

                                                         {{0.0562, -0.1731, -0.0210, 0.0151, -0.2076}}},

                                                        {{{0.1384, 0.0929, -0.0543, 0.1818, -0.1568}},

                                                         {{0.2035, 0.1823, 0.1624, 0.2130, -0.0574}},

                                                         {{-0.1107, 0.0181, 0.2102, 0.0901, 0.0674}},

                                                         {{0.1627, -0.1568, 0.1168, -0.1022, 0.1146}}},

                                                        {{{0.0895, 0.1269, 0.0943, -0.1287, 0.1671}},

                                                         {{-0.1593, 0.0356, 0.0904, -0.0782, 0.0399}},

                                                         {{0.1308, -0.2191, 0.0500, 0.1633, -0.0491}},

                                                         {{0.1263, 0.0886, 0.1541, -0.0718, -0.1566}}},

                                                        {{{-0.0131, 0.1320, 0.1492, 0.0484, -0.0878}},

                                                         {{-0.2079, -0.1104, 0.1458, 0.0992, 0.2083}},

                                                         {{0.1383, 0.1260, -0.1183, 0.1426, -0.1598}},

                                                         {{0.2128, -0.1786, -0.1800, -0.1033, -0.1735}}},

                                                        {{{0.2126, 0.1020, -0.1849, -0.1003, -0.1578}},

                                                         {{-0.1121, 0.0129, 0.1498, -0.1981, 0.0677}},

                                                         {{-0.0499, 0.0983, -0.1312, 0.0649, 0.1694}},

                                                         {{0.0342, 0.1045, -0.1448, -0.1096, -0.0389}}},

                                                        {{{0.1156, 0.0510, 0.0998, -0.1816, -0.1413}},

                                                         {{-0.0259, 0.2187, -0.0730, 0.0580, -0.1685}},

                                                         {{0.1186, 0.1515, -0.1938, -0.1445, -0.2096}},

                                                         {{0.1567, -0.0606, -0.0662, -0.0012, 0.1589}}},

                                                        {{{0.0930, -0.1160, 0.1122, 0.2176, -0.0675}},

                                                         {{-0.0945, 0.0554, -0.2108, 0.0919, -0.1721}},

                                                         {{-0.1134, 0.0061, 0.1270, 0.0901, 0.1088}},

                                                         {{0.0646, 0.1591, 0.0618, 0.1304, 0.0580}}},

                                                        {{{0.0953, 0.1884, 0.2075, -0.1481, 0.1538}},

                                                         {{-0.0418, 0.1070, -0.0232, 0.1442, -0.0280}},

                                                         {{0.0217, 0.0314, 0.1546, 0.1683, 0.0060}},

                                                         {{0.1226, 0.2154, 0.1005, 0.1563, 0.0228}}},

                                                        {{{0.1171, 0.2142, -0.0175, -0.0403, 0.1304}},

                                                         {{0.1393, -0.0058, 0.0377, -0.1083, -0.0155}},

                                                         {{-0.1296, -0.1808, -0.0012, 0.0429, -0.0597}},

                                                         {{0.0434, -0.0180, -0.0067, 0.0430, -0.1182}}},

                                                        {{{0.1258, 0.0113, -0.0645, -0.1054, -0.2031}},

                                                         {{0.2165, 0.0314, -0.1227, -0.0088, -0.1344}},

                                                         {{-0.1634, -0.0031, -0.1940, -0.1407, -0.0672}},

                                                         {{0.0901, -0.2011, -0.0813, 0.0140, 0.0712}}},

                                                        {{{0.0364, 0.0788, 0.1870, -0.1679, 0.1038}},

                                                         {{-0.0076, 0.0664, -0.2232, 0.1597, 0.0767}},

                                                         {{-0.1793, -0.2081, -0.2202, -0.1293, 0.1920}},

                                                         {{0.0805, -0.1440, 0.0447, -0.1694, -0.0202}}},

                                                        {{{0.1834, 0.1427, -0.1922, -0.1329, 0.0657}},

                                                         {{0.0830, -0.0376, 0.2075, 0.0738, -0.0393}},

                                                         {{-0.0109, -0.1579, -0.2076, -0.0673, 0.0461}},

                                                         {{-0.0371, -0.0695, -0.1148, -0.0100, -0.1454}}},

                                                        {{{0.0605, 0.0975, -0.0935, -0.2158, -0.0462}},

                                                         {{-0.1817, 0.1192, -0.1680, -0.1594, 0.1774}},

                                                         {{0.0579, 0.1846, 0.0160, -0.1933, 0.1613}},

                                                         {{0.1741, 0.0194, 0.0969, -0.1899, -0.0978}}}};

static float fake_bias_data[C_OUT] = {0.0022, 0.1099, 0.0712, -0.2227, -0.1244, 0.2145, 0.0474, -0.1233,
                                      -0.0975, -0.1855, 0.0012, 0.1518, -0.0975, 0.0025, 0.0145, -0.1955,
                                      -0.1083, 0.1207, 0.1510, 0.1359, 0.1083, -0.0302, 0.1087, -0.1763};

#if 1
static float output_data_true[N_OUT][C_OUT][H_OUT][W_OUT] = {{{{0.1356, -0.5697, -0.0391, -0.4149, -0.6184, -0.2861, 0.4547,
                                                                0.2733, 0.8169, 0.0850, -0.2731, -0.0486, -0.8412, -0.6772,
                                                                -0.4118, -1.2111, 0.7067, -0.8473, -0.6409, -0.0573, -0.4826,
                                                                0.2927, -0.4865, -0.3132, 0.0201, 0.2347, 0.3545, -0.2045,
                                                                0.2099, 0.3887, -0.4594, 0.0762}},

                                                              {{0.1166, 0.3582, -0.0556, 0.6505, 0.4264, -0.7366, 0.3642,
                                                                0.6366, 0.0712, -0.3522, 0.0261, 0.0318, 0.1120, -0.3078,
                                                                0.9252, 0.1886, 0.6900, 0.4049, 0.3481, 0.8512, 0.3572,
                                                                -0.1427, -0.1897, -0.2450, -0.0343, 0.3440, 0.6946, -0.6061,
                                                                0.3783, -0.5975, -0.7761, -0.1077}},

                                                              {{0.1956, -0.3395, -0.1023, 1.0309, -0.3225, -0.6954, 0.1029,
                                                                0.7264, 0.4300, -1.1304, 0.1883, -0.1295, 0.2981, -1.3415,
                                                                -0.0047, 0.2734, -0.3633, -0.3499, 0.0117, -0.2354, -0.8280,
                                                                -0.3531, 0.5133, -0.0392, 0.4160, -1.0646, 0.0629, 0.5457,
                                                                -0.2545, -0.0185, 0.9366, 0.3823}},

                                                              {{-0.0494, -0.3311, 0.0470, 0.6934, -0.0364, -0.8920, 0.2340,
                                                                -0.9524, -0.0678, -0.8470, -0.5330, 0.8929, -0.0034, -0.9162,
                                                                0.2958, -0.1345, -0.3064, -0.0392, 0.0744, -0.0053, -0.8868,
                                                                -0.1417, 0.3306, -0.3874, 0.0253, -0.7898, -0.5213, 0.0869,
                                                                -0.6345, -0.0712, 0.2485, -0.6473}},

                                                              {{-1.0421, -0.4659, 0.2471, -0.4494, -0.3131, 0.3309, 0.6451,
                                                                -1.0858, -0.0035, 0.2367, 0.0503, -0.8116, -0.8959, 1.1077,
                                                                0.4364, -0.2787, -0.1948, 0.2274, -0.0040, 0.1673, 0.2919,
                                                                -0.6499, -0.2290, -0.2826, 0.0392, 0.6250, 0.0319, -0.5487,
                                                                -0.2866, 0.0450, -1.0119, 0.0489}},

                                                              {{0.1238, -0.2579, 0.3406, 0.1429, 0.3713, 0.5972, 0.3378,
                                                                -0.4526, 0.0554, -0.0717, -0.1045, 1.2147, 0.9270, 0.4350,
                                                                0.4698, 0.1080, 0.8294, -0.1801, 0.6091, 0.4927, 0.0922,
                                                                0.7205, 0.3704, 0.0235, 0.4453, 0.6667, 0.3134, 0.0919,
                                                                0.4132, 0.4775, -0.0757, -0.2517}},

                                                              {{0.1853, 0.3171, -0.1929, 0.8444, -0.2862, -0.8064, -0.2780,
                                                                0.8936, 0.6243, -0.8960, 0.1755, -0.2140, 0.5460, -0.7503,
                                                                -0.2182, -0.0292, -0.0514, -0.0716, -0.1055, 0.1367, -0.4771,
                                                                -0.3644, -0.0237, -0.1518, 0.4577, -0.6187, 0.2312, 0.2709,
                                                                0.0922, -0.5262, 0.0990, 0.3315}},

                                                              {{-1.3216, 0.1401, 0.1413, -0.9640, -0.3760, 0.0768, 0.6439,
                                                                -0.7505, 0.0222, 0.2787, 0.4673, -2.1000, 0.0884, 0.1809,
                                                                -0.5683, -0.5763, -0.4009, -0.1174, -1.1052, -0.1407, -0.1638,
                                                                -1.4438, -0.1081, -0.4444, 0.5670, 0.0677, -0.3345, -0.6867,
                                                                0.1421, -0.1722, -0.2645, 0.9786}},

                                                              {{-0.4031, 0.3879, -0.6045, -0.1114, 0.1085, 0.3906, -0.0076,
                                                                -0.3554, -0.3583, -0.0205, 0.6724, -1.0536, 0.7683, -0.8849,
                                                                -0.1870, 0.4829, -0.2904, 0.4568, -0.1341, 0.6734, 0.4259,
                                                                -0.0769, -0.0773, -0.8304, 0.7057, -0.5465, -0.4204, 0.2503,
                                                                -0.1563, -0.8189, 0.1427, -0.3782}},

                                                              {{-0.7642, 0.0063, 0.3655, -0.1660, -0.0894, 0.5745, -0.7485,
                                                                -1.1780, 0.7511, -0.3818, 0.3202, -1.1967, 0.0437, -0.1299,
                                                                -1.2877, 0.5541, -0.3680, -0.1692, 0.0226, -0.1532, 0.0096,
                                                                -0.3407, 0.0526, -0.7983, 0.7673, -0.7375, -1.4406, 0.5482,
                                                                0.2056, -0.2425, -0.4338, -0.0980}},

                                                              {{0.0542, 0.1972, 0.2520, 0.3179, -0.2458, -1.0631, 1.1649,
                                                                0.7084, -0.2865, -0.3634, 0.0513, 0.4471, -0.3314, -0.0355,
                                                                -0.0572, 0.0683, -0.2022, 0.1619, -0.2906, 0.2551, 0.3075,
                                                                -0.1897, 0.2159, 0.0640, -0.2230, 0.3946, 0.4469, -0.0024,
                                                                -0.2243, -0.3946, -0.0767, 0.0130}},

                                                              {{-0.2649, 0.7155, -0.0977, 0.4301, 0.0048, -0.0225, -0.1643,
                                                                0.5871, -0.2053, 0.3780, 0.4098, -0.1015, -0.0839, 0.3658,
                                                                -0.4663, 0.2641, 0.5047, 0.2361, 0.3406, 0.2544, 0.1393,
                                                                -0.7662, -0.0279, 0.4493, -0.2189, 0.4388, 0.3439, -0.8774,
                                                                0.5231, -0.6206, 0.0597, 0.3996}},

                                                              {{-0.2120, -0.4078, -0.7828, 0.0883, -0.4364, 0.4739, -1.1267,
                                                                0.0734, 1.1221, -0.1151, -0.4147, -0.8371, -0.8296, -0.8315,
                                                                -0.3507, -0.4078, 0.5124, -1.0387, -0.0241, -0.0756, -1.0970,
                                                                -0.2418, -0.8319, -0.1292, 0.2899, -0.4512, -0.2905, -0.4119,
                                                                0.1281, -0.0275, -0.5678, 0.6088}},

                                                              {{-0.4234, 0.3474, -0.3781, -0.4069, 0.4436, -0.4093, 0.0865,
                                                                1.1188, -0.2803, -0.6099, -0.2480, -1.2156, 1.0557, -0.3412,
                                                                0.5158, 1.1771, -0.7187, 0.6108, 0.0351, -0.1510, 0.2801,
                                                                -0.5987, 0.2122, -0.0058, 0.3073, -0.6182, 0.2392, 0.6305,
                                                                -0.2494, -1.1655, 0.5120, 0.4439}},

                                                              {{0.4651, -0.1884, -0.1449, -0.4533, 0.6000, -0.3215, 0.2365,
                                                                1.0225, -0.2909, 0.4756, -1.3167, -1.4514, 0.3759, -0.8239,
                                                                1.0623, 0.6449, -0.1316, 0.0398, -0.0477, 0.4394, 0.2727,
                                                                0.3172, 0.0323, -0.4127, -0.6690, -0.2063, 0.2303, 0.5694,
                                                                -0.0507, -0.0237, 0.0406, -0.4138}},

                                                              {{-0.1375, -0.5663, 0.1593, -0.6164, -0.9550, -0.5347, 0.8566,
                                                                0.2367, 0.3234, -0.0831, -0.3624, -0.3012, -1.5367, -0.6775,
                                                                0.4653, 0.1173, -0.3858, -0.0361, 0.1001, -0.2171, -0.1962,
                                                                0.1766, -0.0773, -0.3144, -0.4007, -0.3550, 0.3804, 0.4539,
                                                                -1.0428, -0.3280, -0.4468, -0.4325}},

                                                              {{0.6251, -0.7398, -0.2934, -0.4705, -0.5215, 0.2771, 0.2438,
                                                                -0.3117, -0.5907, 1.0004, 0.4861, -0.2445, -0.9195, -0.7912,
                                                                0.5711, -0.4079, 0.1174, -0.6992, -0.0378, -0.0507, 0.0587,
                                                                0.3238, -0.1519, -0.3583, -0.3743, 0.2368, -0.1545, -0.2652,
                                                                0.0457, 0.1484, 0.1225, -0.3985}},

                                                              {{0.1986, -0.3089, -0.1155, 0.5124, 0.2335, 0.6327, -0.2810,
                                                                -0.2638, 0.5684, 0.1534, -1.2223, 1.0301, 0.1671, 1.0805,
                                                                0.0891, 0.0654, 0.9313, -0.5465, 0.8770, 0.4166, -0.4284,
                                                                0.0719, -0.0248, 0.5445, 0.3802, 0.6639, -0.3369, 0.2036,
                                                                0.2121, -0.4046, 0.1186, 0.1624}},

                                                              {{-0.2294, -0.5776, -0.3881, -0.1392, 0.6426, -0.0718, 0.4088,
                                                                0.6127, -0.2153, -0.0915, -0.3577, -0.2993, -0.0517, 0.3763,
                                                                0.6025, 0.4135, -0.0265, 0.0700, 0.1439, -0.2399, 0.3631,
                                                                -0.4152, -0.0678, 0.2532, 0.1240, 0.4436, 0.1173, 0.1030,
                                                                0.3629, -0.4417, 0.4521, 0.4593}},

                                                              {{0.0379, 0.5126, 0.0072, 0.0365, 0.7040, -0.0732, 0.0776,
                                                                0.6238, 0.0219, -0.2464, 0.0300, -0.1387, 0.3943, -0.2178,
                                                                0.4182, 0.6897, 0.3075, 0.4058, 0.1996, 0.3297, 0.2271,
                                                                -0.0945, -0.2964, 0.2257, 0.4378, -0.0283, 0.0392, -0.0614,
                                                                0.1051, -0.5548, -0.1178, 0.6298}},

                                                              {{0.8550, 0.1190, 0.0505, 0.1903, -0.2637, 0.2481, 0.2687,
                                                                -0.0091, 0.2752, 0.7175, 0.5771, 0.5299, -0.5641, -0.6635,
                                                                0.4503, -0.5279, 1.0169, -0.5699, 0.0758, 0.6409, -0.0539,
                                                                0.6164, -0.1816, 0.0032, 0.0856, 0.4620, 0.2647, -0.5342,
                                                                0.2969, 0.3100, -0.3827, 0.1276}},

                                                              {{0.0806, -0.2234, 0.9099, 0.1394, -0.3135, -0.4578, 0.6878,
                                                                0.9932, -0.4845, -1.1889, 0.4298, -0.6795, -0.5743, 0.6075,
                                                                0.3621, 0.0985, 0.4079, 0.0126, 0.1409, -0.5480, 0.6116,
                                                                -0.4906, 0.3834, 0.1382, -0.7549, 0.0472, 0.7284, -0.9476,
                                                                0.0257, -0.1323, -0.2428, 0.3448}},

                                                              {{0.5462, 0.6073, -0.1174, 0.1669, -0.1416, -0.5409, 0.4229,
                                                                1.0994, 0.3999, -0.3228, 0.0815, 0.3971, -0.7935, -0.9671,
                                                                0.5860, 0.3544, 0.0339, 0.4061, 0.0123, -0.2575, -0.1900,
                                                                0.5470, 0.2995, 0.2730, -0.4521, -0.6278, 0.7387, 0.0686,
                                                                -0.4452, 0.0270, 0.4977, 0.1796}},

                                                              {{-0.7865, -0.7316, 0.8124, -1.2685, -1.3010, 0.1016, 1.0443,
                                                                0.3906, -1.0338, -0.3111, 1.1237, -1.3881, -1.1344, 0.8164,
                                                                -0.1447, 0.1577, -0.4584, 0.0217, -0.0865, -0.7901, 1.0511,
                                                                -0.2789, -0.0028, -0.6621, -0.8545, 0.6030, 0.7949, -0.6405,
                                                                -0.0922, 0.0351, -0.8943, -0.3432}}}};
#endif

int main()
{
#if MALLOC_ADDR_ALIGNMENT_ENABLE
    float *input_data = NULL;
    float *output_data = NULL;
    float *weight_data = NULL;
    float *bias_data = NULL;

    posix_memalign((void **)&input_data, ALIGNED_ADDR_BYTE, sizeof(float) * N_IN * C_IN * H_IN * W_IN);
    posix_memalign((void **)&output_data, ALIGNED_ADDR_BYTE, sizeof(float) * N_OUT * C_OUT * H_OUT * W_OUT);
    posix_memalign((void **)&weight_data, ALIGNED_ADDR_BYTE, sizeof(float) * C_OUT * C_IN * K_H * K_W);
    posix_memalign((void **)&bias_data, ALIGNED_ADDR_BYTE, sizeof(float) * C_OUT);
#else
    float *input_data = malloc(sizeof(float) * N_IN * C_IN * H_IN * W_IN);
    float *output_data = malloc(sizeof(float) * N_OUT * C_OUT * H_OUT * W_OUT);
    float *weight_data = malloc(sizeof(float) * C_OUT * C_IN * K_H * K_W);
    float *bias_data = malloc(sizeof(float) * C_OUT);
#endif
    memcpy(input_data, fake_input_data, sizeof(float) * N_IN * C_IN * H_IN * W_IN);
    memset(output_data, 0, sizeof(float) * N_OUT * C_OUT * H_OUT * W_OUT);
    memcpy(weight_data, fake_weight_data, sizeof(float) * C_OUT * C_IN * K_H * K_W);
    memcpy(bias_data, fake_bias_data, sizeof(float) * C_OUT);

    int input_size[4] = {N_IN, C_IN, H_IN, W_IN}; // input size
    int kernel_size[2] = {1, 5}; // kernel size
    int stride[2] = {1, 1}; // stride
    int padding[2] = {0, 2}; // padding
    int output_size[4] = {0};

    clock_t start, end;

    start = clock();
    for (int repeat = 0; repeat < REPEAT_PROCESS_COUNT; repeat++)
    {
#if (CONV2D_PROCESS_MODE == CONV2D_PROCESS_MODE_BASIC)
        conv2d_process_basic(input_data, weight_data, bias_data, C_OUT, input_size, kernel_size, stride, padding, output_data, output_size);
#elif (CONV2D_PROCESS_MODE == CONV2D_PROCESS_MODE_BASIC_NHWC)
        conv2d_process_basic_nhwc(input_data, weight_data, bias_data, C_OUT, input_size, kernel_size, stride, padding, output_data, output_size);
#elif (CONV2D_PROCESS_MODE == CONV2D_PROCESS_MODE_NEON_NHWC)
        conv2d_process_neon_nhwc(input_data, weight_data, bias_data, C_OUT, input_size, kernel_size, stride, padding, output_data, output_size);
#elif (CONV2D_PROCESS_MODE == CONV2D_PROCESS_MODE_NEON_PLD_NHWC)
        conv2d_process_neon_pld_nhwc(input_data, weight_data, bias_data, C_OUT, input_size, kernel_size, stride, padding, output_data, output_size);
#elif (CONV2D_PROCESS_MODE == CONV2D_PROCESS_MODE_NEON_V2_NHWC)
        conv2d_process_neon_v2_nhwc(input_data, weight_data, bias_data, C_OUT, input_size, kernel_size, stride, padding, output_data, output_size);
#elif (CONV2D_PROCESS_MODE == CONV2D_PROCESS_MODE_IMG2COL_NWCH)
      conv2d_process_img2col(input_data, weight_data, bias_data, C_OUT, input_size, kernel_size, stride, padding, output_data, output_size);
#endif
    }

    end = clock();

    // 打印输出数据
    for (int n = 0; n < N_OUT; n++) {
        for (int c = 0; c < C_OUT; c++) {
            for (int h = 0; h < H_OUT; h++) {
#if DEBUG_OUTPUT_ENABLE
                printf("n:%d, c:%d, h:%d >>>", n, c, h);
#endif
                for (int w = 0; w < W_OUT; w++) {
#if DEBUG_OUTPUT_ENABLE
                    printf("%f ", output_data[n * C_OUT * H_OUT * W_OUT + c * H_OUT * W_OUT + h * W_OUT + w]);
#endif
                    // 数据对比
                    if (fabs(output_data[n * C_OUT * H_OUT * W_OUT + c * H_OUT * W_OUT + h * W_OUT + w] - output_data_true[n][c][h][w]) > 0.001) {
#if CHECK_PROCESS_RESULT_ENABLE
                        printf("\nprocess data err! n:%d, c:%d, h:%d, w:%d, process:%f, true:%f\n",
                               n, c, h, w, output_data[n * C_OUT * H_OUT * W_OUT + c * H_OUT * W_OUT + h * W_OUT + w], output_data_true[n][c][h][w]);
#endif
                    }
                }
#if DEBUG_OUTPUT_ENABLE
                printf("\n");
#endif
            }
        }
    }

    printf("conv2d_process mode: %d, loop count:%d, time: %f ms\n", CONV2D_PROCESS_MODE, REPEAT_PROCESS_COUNT,(double)(end - start) / CLOCKS_PER_SEC * 1000);
    // 验证内存对齐的影响
    printf("malloc addr:%p, %p, %p, %p is aligned 16byte? %d %d %d %d\n",
           input_data, output_data, weight_data, bias_data,
           ((uintptr_t)input_data & 0xf) == 0, ((uintptr_t)output_data & 0xf) == 0, ((uintptr_t)weight_data & 0xf) == 0, ((uintptr_t)bias_data & 0xf) == 0);

    free(input_data);
    free(output_data);
    free(weight_data);
    free(bias_data);

    return 0;
}
#elif (DATA_PROCESS_MODE == FIXED_DATA_PROCESS)
// 定义假数据
static short fake_input_data[N_IN][C_IN][H_IN][W_IN] = {{{{-1, 7, -3, 1, -3, -8, 9, 4, -9, -8, -8, -2, -7, -4,
                                                           -10, 6, -1, 2, -8, -2, -5, 2, 5, -4, -8, -6, 6, -8,
                                                           3, 0, 9, 0}},

                                                         {{6, -3, -4, 4, -5, 3, 1, -5, 4, 0, -8, 5, 9, -6,
                                                           3, 6, 3, 6, 7, -10, -3, -5, 3, 9, 6, -6, -6, 7,
                                                           4, -2, 4, 0}},

                                                         {{8, 4, -3, 9, 5, -1, 1, 4, 4, 4, 2, 1, -10, -2,
                                                           -2, 2, -10, 5, -9, 0, 7, -8, -10, -10, 0, 1, 6, -2,
                                                           0, 2, 9, -2}},

                                                         {{-5, 0, 8, 8, -5, -9, -2, 8, -1, 1, -6, 7, -2, -6,
                                                           -7, 1, 0, 4, 1, 3, -1, 6, -6, -6, -7, 5, 2, 2,
                                                           6, 2, 1, -2}}}};

static short fake_weight_data[C_OUT][C_IN][K_H][K_W] = {{{{-46, 90, 32, 70, 98}},

                                                         {{49, 47, -77, -32, 67}},

                                                         {{87, 14, 27, 49, -92}},

                                                         {{-61, -67, 31, -55, 84}}},

                                                        {{{-36, 96, -95, -17, -53}},

                                                         {{-100, -71, -85, -81, -78}},

                                                         {{-65, -16, 1, 75, 43}},

                                                         {{42, -39, -70, -45, -45}}},

                                                        {{{62, -80, 43, -64, 90}},

                                                         {{-62, -12, -18, -31, 77}},

                                                         {{-54, 47, -45, 32, -60}},

                                                         {{-31, 76, 12, 39, -54}}},

                                                        {{{5, -68, -33, 45, -43}},

                                                         {{2, 3, 41, -82, -41}},

                                                         {{-28, 7, -27, -5, 76}},

                                                         {{70, 11, -47, 86, 9}}},

                                                        {{{-17, 46, -5, -19, -85}},

                                                         {{67, 72, 82, 43, 35}},

                                                         {{-27, 96, 71, 23, 21}},

                                                         {{-33, -81, 85, -34, 4}}},

                                                        {{{-72, 2, 57, -90, -60}},

                                                         {{-18, 15, -88, 30, -99}},

                                                         {{99, -72, 27, 14, 91}},

                                                         {{26, 81, 67, 50, 37}}},

                                                        {{{98, -45, 59, 40, 51}},

                                                         {{60, 28, -60, 25, -86}},

                                                         {{21, 29, 88, -50, 39}},

                                                         {{-56, -46, -2, 14, -68}}},

                                                        {{{-5, 60, -8, -82, 93}},

                                                         {{65, 57, -59, 3, 23}},

                                                         {{3, -16, -92, -40, 92}},

                                                         {{54, -88, 65, 74, -49}}},

                                                        {{{-25, 25, -37, -4, -3}},

                                                         {{62, -60, 46, -70, 69}},

                                                         {{-24, 58, -80, -86, 99}},

                                                         {{-50, -7, 28, 80, 63}}},

                                                        {{{-26, 54, -60, -22, 14}},

                                                         {{62, 44, 31, 14, -8}},

                                                         {{25, 89, -39, -6, 77}},

                                                         {{-68, -81, -50, 20, -10}}},

                                                        {{{60, -89, 31, -74, 76}},

                                                         {{-38, -98, -67, -78, -87}},

                                                         {{78, -98, 12, -77, 53}},

                                                         {{-22, -96, -42, -90, -11}}},

                                                        {{{41, -52, 25, 55, -29}},

                                                         {{-47, 13, 41, -30, 46}},

                                                         {{0, -74, -50, 37, 8}},

                                                         {{-21, 54, -45, -31, 77}}},

                                                        {{{-64, -100, 40, -22, -48}},

                                                         {{16, -45, -52, -82, -1}},

                                                         {{52, 13, -84, 61, -80}},

                                                         {{63, 94, -75, -82, -38}}},

                                                        {{{-29, -17, 60, -55, -34}},

                                                         {{29, 58, 83, -3, 79}},

                                                         {{-65, 1, 82, -54, -55}},

                                                         {{-3, -6, -71, 86, -79}}},

                                                        {{{87, 52, -56, 45, 99}},

                                                         {{-72, -18, 24, 24, -45}},

                                                         {{-70, -55, 96, -7, -81}},

                                                         {{99, -69, 97, 17, 56}}},

                                                        {{{-1, 55, -8, 90, 81}},

                                                         {{-41, -52, -54, 30, 73}},

                                                         {{89, -44, -70, -81, 91}},

                                                         {{90, 67, -81, 92, -52}}},

                                                        {{{-94, -53, -1, -15, 18}},

                                                         {{-28, -62, -51, -28, -78}},

                                                         {{-8, 26, -47, -85, -24}},

                                                         {{57, -32, -80, -66, -58}}},

                                                        {{{2, -35, -70, -70, 27}},

                                                         {{97, 89, -100, -54, 79}},

                                                         {{-5, -42, 32, -71, 31}},

                                                         {{-42, 80, 15, -81, 13}}},

                                                        {{{-61, 59, -76, 99, 12}},

                                                         {{20, -73, -80, -34, 23}},

                                                         {{-87, -7, 53, 70, 50}},

                                                         {{69, -58, 29, 32, 94}}},

                                                        {{{-80, 56, 61, 35, -59}},

                                                         {{85, 12, -73, 81, 77}},

                                                         {{39, -77, 33, 92, -27}},

                                                         {{-38, -79, 0, -10, 46}}},

                                                        {{{-39, 57, -45, 77, 5}},

                                                         {{12, -11, -18, 20, -17}},

                                                         {{27, -77, 98, 67, 37}},

                                                         {{-53, -81, -84, 83, -88}}},

                                                        {{{-83, -34, 25, 15, -61}},

                                                         {{-47, -67, 53, -80, 30}},

                                                         {{-77, -79, -38, -69, 85}},

                                                         {{53, 50, -51, -48, -41}}},

                                                        {{{23, 89, -28, -12, 90}},

                                                         {{99, -87, 66, -8, 79}},

                                                         {{86, -18, 61, -98, 87}},

                                                         {{30, -36, 52, 61, 82}}},

                                                        {{{73, 38, -47, -43, -89}},

                                                         {{41, 47, -18, -56, -74}},

                                                         {{12, 27, 79, 62, -71}},

                                                         {{98, 4, -33, 54, -10}}}};

static short fake_bias_data[C_OUT] = {5, -9, -6, -1, 1, -10, 7, 2, 0, -2, 2, -2, 1, -8,
                                      -8, -1, -10, -1, -1, -3, -3, -6, 9, -8};

#if 1
static short output_data_true[N_OUT][C_OUT][H_OUT][W_OUT] = {{{{740, 748, 704, -1714, -186, 675, -46, 1281, -3452, -421,
                                                                554, -2483, -2167, 264, 224, -598, 1685, -1986, -2819, 1858,
                                                                -65, 138, -2036, -2847, -1844, 1442, 903, -1208, -286, 1650,
                                                                -237, 900}},

                                                              {{340, -1418, 543, 133, 1252, 543, -690, 735, 2165, 592,
                                                                -678, -1067, 1090, -626, 306, -2918, -1083, -2437, 1547, -600,
                                                                256, -802, -775, 2446, 776, -111, -2582, 1310, -2512, -248,
                                                                -1549, 680}},

                                                              {{-1634, 131, -1152, 1184, 1520, -2582, -173, -1487, -70, 717,
                                                                594, -1119, 687, 111, -758, 399, -209, -1836, 48, 240,
                                                                1149, 1984, -415, -1923, 1, -282, 1005, -1009, 1823, -897,
                                                                -204, -255}},

                                                              {{975, 1069, -356, -429, -1036, 1881, 1518, -2264, 583, 997,
                                                                -222, -663, 564, -537, 146, -9, -1119, -361, 2837, -346,
                                                                238, -1287, -1278, 400, 2001, 859, -1758, 1003, 813, -239,
                                                                -113, -299}},

                                                              {{555, 1383, 1266, 708, -467, -854, 680, 3177, 714, 426,
                                                                28, 1238, 296, -1227, 432, 818, 1956, 645, 1198, -1590,
                                                                -1243, -476, -1493, 149, -365, 2394, 75, 300, -666, 806,
                                                                935, 920}},

                                                              {{-779, 1035, 2434, 917, 44, -1202, 768, 3107, 898, -29,
                                                                -148, 1254, -563, 725, -3936, -502, -1001, 2501, -945, 2399,
                                                                -2106, -2091, 1228, -323, -1184, -1832, 2321, 23, 916, 440,
                                                                189, -401}},

                                                              {{-163, 1183, 831, 102, -278, 287, 558, -292, 353, -1381,
                                                                -1161, 436, -3435, -454, -1334, 559, -3045, 1843, -1712, 342,
                                                                27, -1134, -1918, -2759, 953, -191, 498, -2210, 856, -436,
                                                                1268, -433}},

                                                              {{-3187, 1916, 1865, -2497, 243, -685, -656, 1011, -1373, -640,
                                                                -1014, 205, -1704, 2549, -1330, 79, -314, 671, 1261, 477,
                                                                -429, -802, -405, 464, 1712, -101, -238, -124, 1383, -555,
                                                                -890, 576}},

                                                              {{-689, 2255, 859, -1774, -1706, 610, 363, 438, -282, -297,
                                                                -290, 32, 758, -1332, 415, 1310, 849, -846, 3155, -2666,
                                                                1122, -333, 13, -797, 845, 1168, 752, 1556, 56, -1155,
                                                                -734, 332}},

                                                              {{-359, 1439, 1884, -2467, -69, 1525, 261, 1205, 587, -588,
                                                                273, 202, 639, -55, 725, 216, 1317, -575, 1918, -1777,
                                                                -1070, -1701, -578, 346, 1720, 548, -454, 834, -559, -244,
                                                                -1157, 1348}},

                                                              {{-844, -173, -1742, 422, -138, 1322, 457, -1377, -403, 1430,
                                                                -2340, 1953, -1416, 2354, -2044, 1657, -5546, 1929, -2538, 1742,
                                                                -453, -451, 841, 596, 1873, -2377, 402, -2529, 1241, -3950,
                                                                117, -1921}},

                                                              {{1162, -443, -1836, 557, -1293, 378, 1234, -1679, -896, 849,
                                                                -779, -2322, 1374, 369, -148, 873, 414, -547, 211, 561,
                                                                -1868, -64, 1015, 1311, 774, 344, -748, -763, 1360, -246,
                                                                -377, -788}},

                                                              {{-228, -1956, -1029, 1376, 1331, 510, 294, -1472, -35, 1515,
                                                                2434, 13, 2852, 1383, 425, -1943, 538, -2274, -100, 2344,
                                                                766, 2089, 2269, -630, -2538, 11, 359, -1194, -1004, 694,
                                                                -82, -352}},

                                                              {{168, 1076, -1963, 527, 67, -2515, 1582, 60, -196, -686,
                                                                1992, 523, 882, 404, 1299, 1818, 1318, 816, 370, -1542,
                                                                2485, -91, 901, -381, 1291, 745, 795, -836, -632, -87,
                                                                1352, -142}},

                                                              {{1264, -779, -1367, 21, 216, 641, -2409, -1806, -453, 670,
                                                                -2555, -209, -3907, -716, 415, -418, -2509, 1693, -1579, 871,
                                                                1135, -167, -3796, 1288, 978, -881, -1834, 1270, 674, -357,
                                                                880, -360}},

                                                              {{-1480, 136, 507, -1657, 575, 2078, -386, -2882, -1335, -1711,
                                                                220, -1318, -879, 712, -1152, -492, -1064, -1507, -1071, -1914,
                                                                669, 1048, 3090, -1358, -1753, -3485, -843, 1840, 1395, 102,
                                                                -499, 699}},

                                                              {{-786, -1093, -1720, -1553, 1855, 1335, -660, -1422, -869, -3,
                                                                804, 2698, 1218, 1162, 1091, 235, -1308, -764, -256, -282,
                                                                2052, 2344, 1875, 784, -819, -1329, -55, 169, -1823, -989,
                                                                -364, -125}},

                                                              {{-1348, 487, -1256, 558, 2187, -1501, -1924, 829, -246, 2091,
                                                                1335, -1144, 768, 4171, -634, 224, -728, 678, 768, 2523,
                                                                1140, -474, 103, -1429, 1506, 2164, 1932, -2802, 597, -41,
                                                                -384, -640}},

                                                              {{1423, 847, 842, -1711, -356, 2032, -437, 539, -1323, 142,
                                                                194, -1951, -3266, -815, 2232, -1420, -309, -2411, 368, 37,
                                                                1944, -1345, -3777, -649, -78, 2944, -103, 1732, -1314, 1929,
                                                                -376, -123}},

                                                              {{450, 159, 1681, -897, -2010, -507, 1790, 3330, -2404, -1823,
                                                                2219, -787, -2030, 1006, 1875, -185, 3081, -399, -2952, 1473,
                                                                -682, -879, 744, -428, -1648, 2615, 2025, -1352, -1730, 2451,
                                                                -77, -457}},

                                                              {{1123, -488, 2073, -402, -1761, 856, 1877, 604, 360, -2465,
                                                                1128, -821, -1506, -690, 1853, -749, 153, -628, -1323, -777,
                                                                1047, -2940, -880, -1033, 1733, 911, -773, 316, -1023, 1499,
                                                                -663, -412}},

                                                              {{-213, -798, -2667, 852, -13, -598, 720, -1056, -594, 22,
                                                                -1102, 674, 3013, 535, 279, 1486, -829, -698, 1980, -2264,
                                                                1339, 1063, 3280, 1981, 351, -380, -663, 396, -315, -707,
                                                                229, -1017}},

                                                              {{18, 1979, 905, -762, -951, 2226, -1275, 85, -425, -1,
                                                                -1442, 544, -3267, 17, -749, 895, -1936, 1885, -839, -1526,
                                                                1166, -2254, -384, -1480, -27, -1788, 1341, 1535, 1197, -1096,
                                                                1407, 72}},

                                                              {{1539, -32, 771, 1505, 351, 588, -365, -226, 3131, 1779,
                                                                1066, -1173, -887, -406, -328, -3506, -627, 1028, 925, 2260,
                                                                151, -2117, -2680, 383, 638, 489, -1948, -91, -1382, 484,
                                                                882, 815}}}};
#endif

int main()
{
#if MALLOC_ADDR_ALIGNMENT_ENABLE
    short *input_data = NULL;
    int32_t *output_data = NULL;
    short *weight_data = NULL;
    short *bias_data = NULL;

    posix_memalign((void **)&input_data, ALIGNED_ADDR_BYTE, sizeof(short) * N_IN * C_IN * H_IN * W_IN);
    posix_memalign((void **)&output_data, ALIGNED_ADDR_BYTE, sizeof(int32_t) * N_OUT * C_OUT * H_OUT * W_OUT);
    posix_memalign((void **)&weight_data, ALIGNED_ADDR_BYTE, sizeof(short) * C_OUT * C_IN * K_H * K_W);
    posix_memalign((void **)&bias_data, ALIGNED_ADDR_BYTE, sizeof(short) * C_OUT);
#else
    short *input_data = malloc(sizeof(short) * N_IN * C_IN * H_IN * W_IN);
    int32_t *output_data = malloc(sizeof(int32_t) * N_OUT * C_OUT * H_OUT * W_OUT);
    short *weight_data = malloc(sizeof(short) * C_OUT * C_IN * K_H * K_W);
    short *bias_data = malloc(sizeof(short) * C_OUT);
#endif
    memcpy(input_data, fake_input_data, sizeof(short) * N_IN * C_IN * H_IN * W_IN);
    memset(output_data, 0, sizeof(int32_t) * N_OUT * C_OUT * H_OUT * W_OUT);
    memcpy(weight_data, fake_weight_data, sizeof(short) * C_OUT * C_IN * K_H * K_W);
    memcpy(bias_data, fake_bias_data, sizeof(short) * C_OUT);

    int input_size[4] = {N_IN, C_IN, H_IN, W_IN}; // input size
    int kernel_size[2] = {1, 5}; // kernel size
    int stride[2] = {1, 1}; // stride
    int padding[2] = {0, 2}; // padding
    int output_size[4] = {0};

    clock_t start, end;

    start = clock();
    for (int repeat = 0; repeat < REPEAT_PROCESS_COUNT; repeat++)
    {
#if (CONV2D_PROCESS_MODE == CONV2D_PROCESS_MODE_BASIC)
        conv2d_process_basic_fixed(input_data, weight_data, bias_data, C_OUT, input_size, kernel_size, stride, padding, output_data, output_size);
#elif (CONV2D_PROCESS_MODE == CONV2D_PROCESS_MODE_BASIC_NHWC)
        conv2d_process_basic_nhwc_fixed(input_data, weight_data, bias_data, C_OUT, input_size, kernel_size, stride, padding, output_data, output_size);
#elif (CONV2D_PROCESS_MODE == CONV2D_PROCESS_MODE_NEON_NHWC)
        conv2d_process_neon_nhwc_fixed(input_data, weight_data, bias_data, C_OUT, input_size, kernel_size, stride, padding, output_data, output_size);
#elif (CONV2D_PROCESS_MODE == CONV2D_PROCESS_MODE_NEON_PLD_NHWC)
        conv2d_process_neon_pld_nhwc_fixed(input_data, weight_data, bias_data, C_OUT, input_size, kernel_size, stride, padding, output_data, output_size);
#elif (CONV2D_PROCESS_MODE == CONV2D_PROCESS_MODE_NEON_V2_NHWC)
        conv2d_process_neon_v2_nhwc_fixed(input_data, weight_data, bias_data, C_OUT, input_size, kernel_size, stride, padding, output_data, output_size);
#endif
    }
    end = clock();

    // 打印输出数据
    for (int n = 0; n < N_OUT; n++) {
        for (int c = 0; c < C_OUT; c++) {
            for (int h = 0; h < H_OUT; h++) {
#if DEBUG_OUTPUT_ENABLE
                printf("n:%d, c:%d, h:%d >>>", n, c, h);
#endif
                for (int w = 0; w < W_OUT; w++) {
#if DEBUG_OUTPUT_ENABLE
                    printf("%f ", output_data[n * C_OUT * H_OUT * W_OUT + c * H_OUT * W_OUT + h * W_OUT + w]);
#endif
                    // 数据对比
                    if (fabs(output_data[n * C_OUT * H_OUT * W_OUT + c * H_OUT * W_OUT + h * W_OUT + w] - output_data_true[n][c][h][w]) > 0.001) {
#if CHECK_PROCESS_RESULT_ENABLE
                        printf("\nprocess data err! n:%d, c:%d, h:%d, w:%d, process:%d, true:%d\n",
                               n, c, h, w, output_data[n * C_OUT * H_OUT * W_OUT + c * H_OUT * W_OUT + h * W_OUT + w], output_data_true[n][c][h][w]);
#endif
                    }
                }
#if DEBUG_OUTPUT_ENABLE
                printf("\n");
#endif
            }
        }
    }

    printf("conv2d_process mode: %d, loop count:%d, time: %f ms\n", CONV2D_PROCESS_MODE, REPEAT_PROCESS_COUNT,(double)(end - start) / CLOCKS_PER_SEC * 1000);
    // 验证内存对齐的影响
    printf("malloc addr:%p, %p, %p, %p is aligned 16byte? %d %d %d %d\n",
           input_data, output_data, weight_data, bias_data,
           ((uintptr_t)input_data & 0xf) == 0, ((uintptr_t)output_data & 0xf) == 0, ((uintptr_t)weight_data & 0xf) == 0, ((uintptr_t)bias_data & 0xf) == 0);


    free(input_data);
    free(output_data);
    free(weight_data);
    free(bias_data);

    return 0;
}
#endif
